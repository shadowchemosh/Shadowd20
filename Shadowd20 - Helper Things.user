<?xml version="1.0" encoding="UTF-8"?>
<document signature="Hero Lab Data">
  <fileinfo>
    <info_author>Tim Shadow
      Email: ShadowChemosh@yahoo.com

      This is a houserules file for a group of gamers in Romeoville, IL.  To see the changes vist our wiki at http://shadowd20.pbworks.com/PRPG</info_author>
    <info_history><![CDATA[]]></info_history>
    </fileinfo>

  <thing id="mecS20" name="Shadow d20 Mechanic" description="Shadow d20 Potions &amp; Scrolls\nShadow d20 Wondrous Items\nShadow d20 Rods\nShadow d20 Rogue Skill Tricks\nShadow d20 Teamwork feats\nShadow d20 Fix X-bows\nShadow d20 Two-Handed Weapons\nShadow d20 Casting Time change\nShadow d20 Spell bonus damage\nShadow d20 Mythic Text Changes\n\n--Tags--\nwRangeInc.250 - 250ft range increment tag" compset="Mechanics">
    <usesource source="pShadowd20"/>
    <tag group="wRangeInc"  tag="250"/>
    <tag group="ProductId"  tag="Shadowd20"  name="Shadow d20"/>
    <tag group="Usage"      tag="S2Encount"  name="/encounter"/>
    <tag group="abCategory" tag="S2Warlock"  name="Warlock Hex" abbrev="Hex"/>
    <tag group="abCategory" tag="S2WolfFaSt" name="Barbarian(Wolf Fang Strike Totem)" abbrev="Wolf Fang Strike"/>
    <tag group="abCategory" tag="S2RogSkTr"  name="Rogue Skill Trick"/>

    <!-- Combat and weapons -->
    <bootstrap thing="S2TwoHand"></bootstrap>  <!-- Power Attack and 2H weapons don't get 1.5x Str until level 6 -->
    <bootstrap thing="s20SpellCo"></bootstrap> <!-- TWF for Magus and Touch Attack weapon -->
    <bootstrap thing="s20TWF"></bootstrap>     <!-- TWF no longer gives -2 to hit -->

    <!-- Make these items put in a Item ID Text -->
    <bootstrap thing="s20Potions"></bootstrap>
    <bootstrap thing="s20Wondrou"></bootstrap>

    <!-- Misc Changes -->
    <bootstrap thing="s20ActPoin"></bootstrap> <!-- NPCs Action Points are zero -->
    <bootstrap thing="s20SkillPo"></bootstrap> <!-- Specific classes get bonus skill points -->
    <bootstrap thing="s20MiscTxt"></bootstrap> <!-- Update Things with Shadow d20 house rule notes -->
    <bootstrap thing="s20MythTxt"></bootstrap> <!-- Update Mythic Things with Shadow d20 house rule notes -->
    <bootstrap thing="s20UAETxt"></bootstrap>  <!-- Update Text for Unchained Action Economy -->
    <bootstrap thing="s20UnAcEc"></bootstrap>  <!-- Unchained Action Economy to force display three attacks -->
    
    <!-- Removed this for now as its costing a HIGH amount of CPU and no one still takes
         any team work feats. -->
    <!-- <bootstrap thing="S20Teamwor"></bootstrap>  House rule note for Team Work feats  -->

    <!-- Spell Casting -->
    <bootstrap thing="s20CastTim"></bootstrap> <!-- 1 round spells are Full-Round spells -->
    <bootstrap thing="s20SpelDmg"></bootstrap> <!-- Give Spells bonus damage --> 
    <bootstrap thing="s20DblSpls"></bootstrap> <!-- Double 9 level arcane spells per day --> 
    <bootstrap thing="s20DblSFDC"></bootstrap> <!-- Double DC bonus for Spell Focus and Greater Spell Focus --> 

    <!-- Rogue Class Changes -->
    <bootstrap thing="s20Rogue"></bootstrap>   <!-- Rogue class gets Skill Tricks. Unchained does NOT. -->
    <bootstrap thing="s20Rogue2"></bootstrap>  <!-- Rogue and Unchained Rogue Talents are usuable per encounter not day -->

    <!-- This gives an option where XP is not needed -->
    <bootstrap thing="s20NoXP"></bootstrap>

    <!-- Archetype Class Changes for the Unchained Rogue -->
    <bootstrap thing="s20RogueUn"></bootstrap>
   
    <!-- Test Notes Only simple Things -->
    <bootstrap thing="S2CureSpls"></bootstrap>

    <eval phase="First" priority="10000"><![CDATA[
      ~ If not human get out now
      ~#hasrace[rHuman] + #hasrace[rElf] + #hasrace[rDwarf] +
      doneif (#hasrace[rHalfling] = 0)

      Call GiveEthnic
      ]]></eval>

    <eval phase="Final" priority="10000" index="2"><![CDATA[
      perform hero.assign[Shadowd20.HouseRule]
      ]]></eval>

    </thing>

  <!-- 22 Point Buy Option -->
  <thing id="creaMedium" name="Medium Fantasy" compset="Creation">
    <fieldval field="creaName" value="Point Buy: Shadow d20, 22"/>
    <fieldval field="creaAttPts" value="22"/>
    <usesource source="s20PFCamp"/>
    <tag group="explicit" tag="70" name="70" abbrev="70"/>
    </thing>

  <!-- ======================================================================================= -->
  <!-- Automatic level bonus mechanic.                                                         -->
  <!--     mechTrait = Resistance Bonus to save progression table.                             -->
  <!--     mechFlaw  = Natural Armor Bonus progression table.                                  -->
  <!--     mechDrawb = Deflection Armor Bonus progression table.                               -->
  <!-- ======================================================================================= -->
  <thing id="mecS2ALvlB" name="Shadow d20 Automatic Level Bonus" compset="Mechanics" uniqueness="unique">
    <comment>Trait = Resistance bonus to saves; Flaw = Natural Armor bonus; Drawback = Deflection Armor Bonus;</comment>
    <arrayval field="mechTrait" index="2" value="1"/>
    <arrayval field="mechTrait" index="3" value="1"/>
    <arrayval field="mechTrait" index="4" value="1"/>
    <arrayval field="mechTrait" index="5" value="1"/>
    <arrayval field="mechTrait" index="6" value="2"/>
    <arrayval field="mechTrait" index="7" value="2"/>
    <arrayval field="mechTrait" index="8" value="2"/>
    <arrayval field="mechTrait" index="9" value="2"/>
    <arrayval field="mechTrait" index="10" value="3"/>
    <arrayval field="mechTrait" index="11" value="3"/>
    <arrayval field="mechTrait" index="12" value="3"/>
    <arrayval field="mechTrait" index="13" value="3"/>
    <arrayval field="mechTrait" index="14" value="4"/>
    <arrayval field="mechTrait" index="15" value="4"/>
    <arrayval field="mechTrait" index="16" value="4"/>
    <arrayval field="mechTrait" index="17" value="4"/>
    <arrayval field="mechTrait" index="18" value="5"/>
    <arrayval field="mechTrait" index="19" value="5"/>
    <arrayval field="mechTrait" index="20" value="5"/>
    <arrayval field="mechFlaw" index="3" value="1"/>
    <arrayval field="mechFlaw" index="4" value="1"/>
    <arrayval field="mechFlaw" index="5" value="1"/>
    <arrayval field="mechFlaw" index="6" value="1"/>
    <arrayval field="mechFlaw" index="7" value="2"/>
    <arrayval field="mechFlaw" index="8" value="2"/>
    <arrayval field="mechFlaw" index="9" value="2"/>
    <arrayval field="mechFlaw" index="10" value="2"/>
    <arrayval field="mechFlaw" index="11" value="3"/>
    <arrayval field="mechFlaw" index="12" value="3"/>
    <arrayval field="mechFlaw" index="13" value="3"/>
    <arrayval field="mechFlaw" index="14" value="3"/>
    <arrayval field="mechFlaw" index="15" value="4"/>
    <arrayval field="mechFlaw" index="16" value="4"/>
    <arrayval field="mechFlaw" index="17" value="4"/>
    <arrayval field="mechFlaw" index="18" value="4"/>
    <arrayval field="mechFlaw" index="19" value="5"/>
    <arrayval field="mechFlaw" index="20" value="5"/>
    <arrayval field="mechDrawb" index="4" value="1"/>
    <arrayval field="mechDrawb" index="5" value="1"/>
    <arrayval field="mechDrawb" index="6" value="1"/>
    <arrayval field="mechDrawb" index="7" value="1"/>
    <arrayval field="mechDrawb" index="8" value="2"/>
    <arrayval field="mechDrawb" index="9" value="2"/>
    <arrayval field="mechDrawb" index="10" value="2"/>
    <arrayval field="mechDrawb" index="11" value="2"/>
    <arrayval field="mechDrawb" index="12" value="3"/>
    <arrayval field="mechDrawb" index="13" value="3"/>
    <arrayval field="mechDrawb" index="14" value="3"/>
    <arrayval field="mechDrawb" index="15" value="3"/>
    <arrayval field="mechDrawb" index="16" value="4"/>
    <arrayval field="mechDrawb" index="17" value="4"/>
    <arrayval field="mechDrawb" index="18" value="4"/>
    <arrayval field="mechDrawb" index="19" value="4"/>
    <arrayval field="mechDrawb" index="20" value="5"/>
    <usesource source="srcLvlBon"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    
    <!-- Automatic Level Bonus simple thing -->
    <bootstrap thing="S2AutoLvlB"></bootstrap>
    </thing>

  <!-- ======================================================================================= -->
  <!--              Automatic Level Bonus                                                      -->
  <!-- ======================================================================================= -->
  <thing id="S2AutoLvlB" name="Shadow d20 Automatic Level Bonus" 
    description="In a attempt to remove the need of some of the 'big six' magic items an automatic bonus to your saves and AC will be given. View the automatic level bonus section of this tab for details of when you get the bonuses." 
    summary="Automatic level bonus to your characters saves and AC."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcLvlBon"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ This is a test &
      var level as number
      var svBon as number
      var naturalBon as number
      var deflBon as number
      
      ~ Get total level so we can set the arrays
      level = #totallevelcount[]

      ~ Set the different bonus values
      svBon = root.field[mechTrait].arrayvalue[level]
      naturalBon = root.field[mechFlaw].arrayvalue[level]
      deflBon = root.field[mechDrawb].arrayvalue[level]
      
      ~ If we have a save bonus apply
      if (svBon <> 0) then
        #applybonus[svResist,hero.child[svAll],svBon]
      endif
      
      ~ If we have a natural armor bonus apply
      if (naturalBon <> 0) then
        #enhancementbonus[hero.child[mNatural],naturalBon]
      endif
        
      ~ If we have a deflection bonus apply
      if (deflBon <> 0) then
        #applybonus[tACDeflect,hero.child[ArmorClass],deflBon]
      endif
      ]]></eval>
    </thing>

  <!-- ======================================================================================= -->
  <!-- Let players type in Unique ID's for items.                                              -->
  <!-- ======================================================================================= -->
  <thing id="s20Potions" name="Potions, Scrolls, and Wands Require ID" 
    description="To help track magic potions, scrolls and wands in our games we require that a player enter a unique id. A small text box will display next to these items on the 'Magic' tab." 
    summary="Allow entering a ID for potions, scrolls and wands."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcPotID"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="First"><![CDATA[
      ~ If we are a NPC then don't require ID for magic items
      doneif (hero.tagis[CharType.typNPC] = 1) 

      ~ We are active so have us displayed on the Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      foreach pick in hero from MyGear where "gType.OilPotion|gType.Scroll|gType.Wand & !Shadowd20.SkipDomain"
         perform eachpick.assign[User.NeedDomain]
      nexteach]]></eval>
    </thing>

  <thing id="s20Wondrou" name="Magic Items Require ID" 
    description="To help track magic items in our games we require that a player enter a unique id. A small text box will display next to all magic items on the 'Magic' tab." 
    summary="Allow entering a unique ID for magic items."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Final"><![CDATA[
      ~ If we are a NPC then don't require ID for magic items
      doneif (hero.tagis[CharType.typNPC] = 1) 

      ~ We are active so have us displayed on the Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ All Wondrous items EXCEPT for the Shadow d20 -Custom Magic Item-
      foreach pick in hero from MyGear where "(gType.Wonder|gType.Ring|gType.Rod) & !thingid.ioS2Custom & !Shadowd20.SkipDomain"
         perform eachpick.assign[User.NeedDomain]
      nexteach]]></eval>
    </thing>

  <!-- ======================================================================================= -->
  <!-- Rogue Class Fixes                                                                       -->
  <!-- ======================================================================================= -->
  <thing id="s20Rogue" name="Rogue Skill Tricks" 
    description="To try and help with how bad a normal rogue is let them have special 'Skill Tricks' starting at level 1." 
    summary="Rogue's gain access to Skill Tricks now."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Done if no rogue class found
      doneif (hero.childlives[cHelpRog] = 0)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Give 1 point to the Secondary Class Abilities total
      hero.child[cHelpRog].field[cGiveSp2nd].value += maximum(round(#levelcount[Rogue]/2,0,1),1)
      ]]></eval>
    <eval phase="Render" priority="100000" index="2"><![CDATA[
      ~ Done if no rogue class found
      doneif (hero.childlives[cHelpRog] = 0)

      ~ Give name of Skill Tricks
      hero.child[cHelpRog].field[cSpec2ndNm].text = "Skill Tricks"
      hero.child[cHelpRog].field[cSpec2ndSi].text = "Skill Trick"]]></eval>
    </thing>

  <thing id="s20Rogue2" name="Rogue Talent Changes" 
    description="To try and help with Rogue Talents being very poor all the one time a day rogue talents are being changed to once per encounter. This means rogue talents can be used more often.\n\nFinal say of a encounter definition is left in the hands of the DM. It takes 1 minute after the encounter to recover encounter based talents." 
    summary="1/day rogue talents are now 1/encounter."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set text fields
      var sText   as string
      var sChange as string
      var searchexpr as string
      
      searchexpr = "Usage.Day & abCategory.RogTal?"

      sChange = "{b}Shadow d20:{/b} Rogue talents usable 1/day are changed to 1/encounter. Final say of a encounter definition is left in the hands of the DM. It takes 1 minute after the encounter to recover this talent."

      foreach thing in BaseCustSp where searchexpr
        ~ Build text string
        sText = eachthing.field[descript].text & "{br}{br}" & sChange
        ~ Set message
        perform eachthing.amendthing[description,sText]  
      nexteach

      foreach pick in hero from BaseCustSp where searchexpr
        ~ Change usage tag to encounter
        perform eachpick.delete[Usage.?]
        perform eachpick.assign[Usage.S2Encount]
      nexteach          
      ]]></eval>
    </thing>

  <thing id="s20RogueUn" 
    name="Shadow d20 Rogue Unchained" 
    description="Auto apply specific archetypes to the Unchained Rogue class." 
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <bootstrap thing="arS2URog01">
      <containerreq phase="GlobalTest" priority="10050"><![CDATA[Shadowd20.arS2URog01]]></containerreq>    
    </bootstrap>
    <eval phase="GlobalTest" priority="10000"><![CDATA[
      ~ If unchained Rogue class found then apply archetype
      doneif (hero.haschild[BaseClHelp, "thingid.cHelpRogUn"] = 0)

      ~ Set archetype tag onto hero
      perform hero.assign[Shadowd20.arS2URog01]
      
      ~ Let us display in the Shadow d20 tab
      perform assign[Shadowd20.HouseRule]
      ]]></eval>
    </thing>


  <!-- ======================================================================================= -->
  <!-- Some classes need more skill points                                                     -->
  <!-- ======================================================================================= -->
  <thing id="s20SkillPo" name="Class Bonus Skill Points" 
    description="Some classes in Pathfinder simply need more skill points. Currently the following classes are getting increased number of skill points.\n\n-{b}Clerics{/b} increased by 2 per level." 
    summary="Increase some classes skill points per level."
    compset="Simple">
    <usesource source="pShadowd20"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="First" priority="1000"><![CDATA[
      ~ Check to see if we have the cleric class
      If (hero.childlives[cHelpClr] <> 0) Then
         ~ Clerics skill points increased by 2 per level
         hero.child[cHelpClr].field[cSkills].value += 2
         perform assign[Shadowd20.HouseRule]
      Endif
      ]]></eval>
    </thing>

  <!-- ============================================================================================= -->
  <!-- Two-Handed Weapons                                                                            -->
  <!-- ============================================================================================= -->
  <thing id="S2TwoHand" 
    name="Two-Handed Weapons" 
    description="Low level damage output for two-handed weapons is too high. In our games 2HW weapons will This adjusts damage back down to 1x Str and you will not receive an additional +50% damage when using Power Attack. This changes at level 6+ to normal pathfinder rules." 
    summary="2HW get 1x Str dmg and no bonus Power Attack dmg."
    compset="Simple"
    uniqueness="useronce">
    <usesource source="srcTHW"/>
    <usesource source="srcTHW2"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostAttr" priority="200000"><![CDATA[
      if (hero.tagis[source.srcTHW] = 1) then
        ~ If level is 6 or greater then get out now
        doneif (#totallevelcount[] >= 6)
      endif

      ~ We are active so show on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Under the Unchained Action Economy we don't want to use this rule
      doneif (hero.tagis[source.PURevActi] = 1)

      var penalty as number
      var nPower  as number

      ~ Set houserule text on Power Attack
      #appenddesc[fPowerAtt,"{b}Shadow d20:{/b} Two-handed weapons will NO longer get 1.5x Strength damage or get +50% bonus when using Power Attack until your character is level 6."]

      ~ If we have power attack feat then process here
      If (hero.childlives[fPowerAtt] <> 0) Then
        ~ If Power Attack is turned on then we need to off-set +50%
        ~ bonus PA applies.
        If (hero.child[fPowerAtt].field[abilActive].value <> 0) Then
            nPower = #value[fPowerAtt]
        Endif
      Endif

      ~ Loop through only the melee weapons
      foreach pick in hero from BaseWep where "wCategory.Melee"
        ~ Calculate the Bonus of 1.5
        penalty = round(eachpick.field[wMeleeAttr].value/2,0,-1) + nPower
        ~ make our value negative
        penalty *= -1

        ~ Are we a natural attack
        If (eachpick.tagis[wGroup.Natural] <> 0) Then
          ~ And we are a PC then remove the two-handed tag
          If (hero.tagis[CharType.typHero] <> 0) Then
            perform eachpick.delete[Helper.NatTwoHand]
          Endif

        ~...we are a one handed weapon equipped in two hands
        ElseIf (eachpick.tagis[wClass.OneHanded] + eachpick.field[gIsEquip].value + eachpick.field[wIs2nd].value = 3) Then
          ~ Give a penalty
          eachpick.field[wDamBonus].value += penalty

        ~...we are a Double weapon
        ElseIf (eachpick.tagis[wCategory.Double] <> 0) Then
          ~ If we are double weapon and we are equipped in double mode
          ~ then do NOT give penalty as we are treated as a one-handed weapon
          If (eachpick.field[wIsDouble].value <> 1) Then
            eachpick.field[wDamBonus].value += penalty
          Endif

        ~...we are a two-handed weapon
        ElseIf (eachpick.tagis[wClass.TwoHanded] <> 0) Then
          ~ Give a penalty to offset the 1.5 Str damage
          eachpick.field[wDamBonus].value += penalty
        Endif

      nexteach
      ]]></eval>
    </thing>

  <!-- ======================================================================================= -->
  <!-- Action Points                                                                           -->
  <!-- ======================================================================================= -->
  <thing id="s20ActPoin" name="Action Points" 
    description="This sets the action points for NPCs to be zero." 
    summary="1/day rogue talents are now 1/encounter."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostLevel" priority="10010"><![CDATA[
      ~ If we are not a NPC then get out now
      doneif (hero.tagis[CharType.typNPC] = 0)
      ~ If action points tracker not live get out now
      doneif (hero.childlives[hActionPts] <> 1)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Set action points to zero if we are a NPC
      #trkmax[hActionPts] = 0

      #appenddesc[hActionPts,"{b}Shadow d20:{/b} NPCs do not gain any APs unless they take the Heroic Spirit feat"]
      ]]></eval>
    </thing>


  <thing id="s20SpellCo" name="Magus Spell-Combat" 
    description="Correctly have HL calculate the TWF values of a Magus with a weapon and &quot;Touch Attack&quot; weapon when they are equipped in a two-weapon fighting mode." 
    summary="Show correct TWF values when using a touch attack weapon."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PostAttr" priority="10000"><![CDATA[
      ~ If Magus Spell-Combat not live
      doneif (hero.childlives[cMagSplCom] <> 1)
      ~ Make sure we have not been replaced first
      doneif (hero.child[cMagSplCom].tagis[Helper.SpcReplace] <> 0)
      ~ Make sure we don't have two-weapon fighting already
      doneif (hero.tagis[Hero.TwoWep] = 1)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      var Hands as number
      var Touch as number
      Hands = 0
      Touch = 0

      ~ Are we duel wielding?
      Hands = tagexpr[(count:hero#Hero.EquipWep = 2) | hero#Hero.EquipDbl]
      ~ Is Touch attack equipped?
      Touch = hero.tagis[PackHelper.EquipTouch]

      ~ If not duel wielding with a touch attack weapon then get out!
      doneif (Hands + Touch <> 2)
      
      ~ Make us act like we have two-weapon fighting
      foreach pick in hero from BaseWep where "Hero.MainHand | Hero.OffHand"
         If (eachpick.tagis[Hero.MainHand] <> 0) Then
             eachpick.field[wAttMelee].value += 2
         Endif
         If (eachpick.tagis[Hero.OffHand] <> 0) Then
             eachpick.field[wAttMelee].value += 6
             eachpick.field[wAttRanged].value += 6
         Endif
      nexteach
      ]]></eval>
    </thing>


  <thing id="s20TWF" name="Two-Weapon Fighting Feat" 
    description="Two-weapon fighting feat now offsets the penalty down to zero instead of -2 but you lose this bonus if you take the Improved Two-Weapon fighting feat or you two-weapon fight a two-handed weapon.\n\nThis rule change tries to make TWF more attractive to players instead of just using a two-handed weapon." 
    summary="Show correct TWF values when using a touch attack weapon."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcTWF"/>
    <tag group="ProductId" tag="Shadowd20"/>

    <eval phase="PreLevel" priority="10050" index="1"><![CDATA[
      ~ Give note on the feat
      #appenddesc[fTwoWep,"{b}Shadow d20:{/b} TWF now offsets the penalty down to zero instead of -2 but you lose this bonus if you take the Improved Two-Weapon fighting feat or TWF with a two-handed weapon."]

      ~ If we don't have the Two-Weapon Fighting get out now
      doneif (hero.tagis[Hero.TwoWep] <> 1)
      ~ If we have Improved Two-Weapon Fighting get out now
      doneif (#hasfeat[fImpTwoWep] <> 0)
      ~ If we have a two-handed weapon then we don't get the bonus
      doneif (hero.tagcount[Hero.EquipOff] >= 2)
      ~ Under the Unchained Action Economy we don't want to lower the TWF penalty
      doneif (hero.tagis[source.PURevActi] = 1)

      ~ If we passed the above tests set the Shadow d20 Two-Weapon Fighting Tag
      perform hero.assign[Shadowd20.TwoWep]

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]      
      ]]></eval>

    <eval phase="PreLevel" priority="11000" index="2"><![CDATA[
      ~ If we don't have Shadow d20 Two-Weapon Fighting get out now
      doneif (hero.tagis[Shadowd20.TwoWep] <> 1)
      ~remove the attack penalties (This allows for one-handed weapons in the off-hand)
      ~perform hero.assign[Hero.TwoWepSup]

      var Hands as number
      var Bonus as number
      Bonus = 2
      Hands = 0

      ~ Count the number of hands in use
      foreach pick in hero from BaseWep where "Hero.MainHand | Hero.OffHand"
        If (eachpick.field[gIsEquip].value + eachpick.field[wIs2nd].value <> 0) Then
          ~ If we are a Two-handed weapon then we don't count for the bonus
          If (eachpick.tagis[wClass.TwoHanded] <> 1) Then
             Hands += 1
          Endif
        Endif 
      nexteach

      ~ Only give a bonus if we have a weapon in main and off hand
      If (Hands = 2) Then
        ~ Loop through all the weapons in main and off hand but ignore double weapons
        foreach pick in hero from BaseWep where "Hero.MainHand | Hero.OffHand & !wCategory.Double"
           eachpick.field[wAttMelee].value += Bonus
           eachpick.field[wRanAtk].value += Bonus
        nexteach
      Endif

      ~ Loop through all double weapons
      foreach pick in hero from BaseWep where "Hero.MainHand & Hero.OffHand & wCategory.Double"
         ~ Only if in Double weapon mode should we give the bonus
         if (eachpick.field[wIsDouble].value <> 0) Then     
            eachpick.field[wAttMelee].value += Bonus
         Endif
      nexteach
      ]]></eval>

    </thing>

  <!-- ======================================================================================= -->
  <!-- SPELL CHANGES                                                                           -->
  <!-- ======================================================================================= -->
  <thing id="s20CastTim" name="Cast Times" 
    description="All 1 round casting time spells have been adjusted down to 1 Full-Round action instead. In play 1 round spells are too big of a nerf to spellcasters. Please note that the casting time will only be changed AFTER you add the spell to your character not before." 
    summary="1 round spells are now 1 Full-Round action instead."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcNo1Rnd"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <bootstrap thing="s2Info1Rou"></bootstrap>
    <eval phase="PostLevel" priority="15000"><![CDATA[
      ~ Finished if not a Arcane or Divine caster
      doneif (hero.tagis[Hero.Caster] <> 1)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Change all 1 round casting to 1 Full-Round casting time
      foreach pick in hero from BaseSpell where "sCastTime.Round1"
        perform eachpick.tagreplace[sCastTime.Round1,sCastTime.FullAction]
      nexteach
      ]]></eval>
    </thing>

  <thing id="s20SpelDmg" name="Spell Bonus Damage" 
    description="All hit point dealing spells and spell-like abilities now gain a damage bonus equal to your caster level (CL). This bonus only applies once to a spell, not once per missile or ray, and cannot be split between multiple missiles or rays. This bonus damage is not increased by Empower Spell or similar effects. This damage is of the same type as the spell." 
    summary="Hit Point damaging Spells and Sp get your CL as a damage bonus." 
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcSpelDmg"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <bootstrap thing="s2InfoSpDm"></bootstrap>
    <eval phase="PostLevel" priority="15000"><![CDATA[
      ~ Finished if not a Arcane or Divine caster
      doneif (hero.tagis[Hero.Caster] <> 1)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      var sTag as string
      var nCL as number
      var sName as string
      var iX as number
      iX = 0
      sName = " ("

      ~ Loop through all Divine/Arcane caster classes
      foreach pick in hero from Class where "CasterSrc.Arcane|CasterSrc.Divine"
          ~ Build all spec source tags
          sTag = eachpick.tagids[SpecSource.?,"|"]
          ~ Add spell-like ability tag
          sTag &= " & AbilType.SpellLike"
          ~ capture the caster level
          nCL = eachpick.field[cCasterLev].value
          If (iX > 0) Then
             sName &= ", " & eachpick.field[cAbbr].text & " +" & nCL
          Else
             sName &= eachpick.field[cAbbr].text & " +" & nCL
          Endif
          ~ loop through all Class Specials where we have the correct tags
          foreach pick in hero from BaseClSpec where sTag
             ~ Increase damage by the CL
             eachpick.field[DescAppend].text &= "{b}Shadow d20:{/b} If this spell-like ability does hit point damage it gains a bonus equal to your caster level (" & signed(nCL) & ")."  
          nexteach
          ~ increase count
          iX += 1
      nexteach
      sName &= ")"
      ~ Update live name of the Special Ability
      hero.childfound[s2InfoSpDm].field[livename].text = hero.childfound[s2InfoSpDm].field[name].text & sName
      
      ~ Find all touch attack weapons and show Extra Damage
      foreach pick in hero from BaseWep where "PackHelper.Touch"
         #extradamage[eachpick,sName,field[name].text]
      nexteach]]></eval>
    <eval phase="Final" priority="50000" index="2"><![CDATA[
      ~ Finished if not a Arcane or Divine caster
      doneif (hero.tagis[Hero.Caster] <> 1)    
      
      ~ Give damage CL text on to all spells on character
      foreach pick in hero from BaseSpell
        eachpick.field[DescAppend].text &= "{b}Shadow d20:{/b} If this spell does hit point damage it gains a bonus equal to your caster level (" & signed(eachpick.field[sCL].value) & ")."  
      nexteach]]></eval>
    </thing>

  <!-- ==================================================================================== -->
  <!-- Double All Full arcane casters spells                                             -->
  <!-- ==================================================================================== -->
  <thing id="s20DblSpls" name="Arcane Casters Spells" 
    description="Arcane spell casters where falling too far behind other characters when it came to spells per day. This houserule doubles all the spells per day that a Wizard, Sorcerer or Arcanist can cast in our games." 
    summary="Spells per day have been doubled."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcSpelDmg"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <bootstrap thing="s2InfoDbSp"></bootstrap>
    <eval phase="First" priority="10"><![CDATA[
      var SearchExpr as string
      var spelllevel as number
      var level as number

      SearchExpr = "thingid.cHelpWiz|thingid.cHelpSor|thingid.cHelpArc"     
      perform hero.findchild[BaseClHelp,SearchExpr].setfocus
      ~ Only show us if we are a Wizard, Sorcerer, or Arcanist
      doneif (state.isfocus = 0)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Loop through all Wizard, Sorcerer, and Arcanist levels
      ~ This section changes the spells per day matrix
      foreach pick in hero from BaseClHelp where SearchExpr
        for level = 0 to 19
          for spelllevel = 0 to 9
            eachpick.field[cCastTot].matrixvalue[level,spelllevel] *= 2
            eachpick.field[cSecTot].matrixvalue[level,spelllevel] *= 2
          next
        next
      nexteach
      ]]></eval>
    <eval phase="Final" priority="10000" index="2"><![CDATA[
      var SearchExpr as string
      var spelllevel as number
      var level as number
      
      SearchExpr = "thingid.cHelpWiz|thingid.cHelpSor|thingid.cHelpArc"     
      perform hero.findchild[BaseClHelp,SearchExpr].setfocus
      ~ Only show us if we are a Wizard, Sorcerer, or Arcanist
      doneif (state.isfocus = 0)
      
      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Loop through all Wizard, Sorcerer, and Arcanist levels
      ~ This section changes the secondary spells per day array
      foreach pick in hero from BaseClHelp where SearchExpr
        for spelllevel = 0 to 9
          eachpick.field[cSecMax].arrayvalue[spelllevel] *= 2
        next
      nexteach
      ]]></eval>
    </thing>

  <!-- ==================================================================================== -->
  <!-- Double Spell Focus and Greater Spell Focus DC Bonus                                  -->
  <!-- ==================================================================================== -->
  <thing id="s20DblSFDC" name="Spell Focus Feats" 
    description="Double the DC bonus for Spell Focus and Greater Spell Focus feats. We feel that +1 and +2 bonus is way too low of a bonus for our games sense we tend to play with very low point by for ability scores." 
    summary="Double the DC bonus for Spell Focus and Greater Spell Focus feats."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcSpelDmg"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="PreLevel" priority="10000"><![CDATA[
      ~ If no spell focus/greater spell focus just get out now!
      doneif (hero.tagis[Hero.SpellFocus] = 0)

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Loop through spell schools with Spell Focus
      foreach pick in hero from SplSchool where "Broadcast.SpellFocus"
        ~ Add 1 to the DC field on school helper
        eachpick.field[schDC].value += 1

        ~ If we have Greater Spell Focus then give an addtional one
        if (eachpick.tagis[Broadcast.SpellGrFoc] = 1) then
          eachpick.field[schDC].value += 1
        endif          
      nexteach
      ]]></eval>
    </thing>

  <!-- ==================================================================================== -->
  <!-- Unchained Action Economy to display just three attacks                               -->
  <!-- ==================================================================================== -->
  <thing id="s20UnAcEc" name="Unchained Action Economy" 
    description="Unchained Action Economy allows for three attacks at level if you use all three of your Acts. This helper simply forces HL to always show three attacks for all weapons starting from level 1. This makes things easier as you won't have to try and calculate the values during the game." 
    summary="All weapons display 3 attacks."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="srcUnAcEc"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Final" priority="12550"><![CDATA[
      ~ Set hero to only display one attack
      perform hero.assign[Dependant.NoIterAtk]

      ~ Display on Shadow d20 tab
      perform assign[Shadowd20.HouseRule]

      ~ Now set each weapon to display a total of 3 attacks
      foreach pick in hero from BaseWep
        perform eachpick.assign[Helper.ExtraIter]
        perform eachpick.assign[Helper.ExtraIter]
        
        ~ Weapons like Daggers have a special tag to prevent additional
        ~ attacks from displaying. With the unchained rules this does
        ~ make sense. So display all three attacks.
        perform eachpick.delete[Helper.SingleRAtt]
      nexteach
      ]]></eval>
    </thing>

  <!-- ==================================================================================== -->
  <!-- Shadow d20 misc text changes                                                         -->
  <!-- ==================================================================================== -->
  <thing id="s20MiscTxt" name="Shadow d20 Misc Text Changes" 
    description="This Thing sets the text desc on Things with house rules text." 
    compset="Simple">
    <usesource source="s20PFCamp"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Render" priority="200"><![CDATA[
      ~ Add extra text to the Scimitar
      #appenddesc[iReturning,"{b}Shadow d20:{/b} Returning item properity is changed to cause the weapon to return immediately to your hand after being thrown. This means you can throw the same weapon multiple times in a single round if your base attack bonus is high enough."]    

      ~ This has to be added this way as they are doing strange things
      ~ with this items Desc in the "totals" component.
      #appenddesc[wRcHarpoon,"{b}Shadow d20:{/b} Removed the weight of the rope as most times it will not be used that way. Increased the range increment to 50ft to make having the exotic weapon harpoon feet more worth while."]

      ~ Add extra text to the Scimitar
      #appenddesc[wScimitar,"{b}Shadow d20:{/b} A scimitar is treated as a light weapon when used as the off-hand weapon when two-weapon fighting, but only for the purpose of two-weapon fighting. A scimitar used as a off-hand weapon can not be weapon finessed even though its considered a light weapon."]

      ~ Boar Style feat
      #appenddesc[fBoarStyl,"{B}Shadow d20:{/b} The bleed damage on this feat is changed to rend damage which makes allot more sense."]

      ~ TWF and DR
      #appenddesc[fTwoWep,"{b}Shadow d20:{/b} When you fight with two weapons (not including a two-handed weapon) you may add the damage of your primary attack and off-hand attack together vs DR. This allows a more balanced approach vs two-handed weapons."]

      ~ Lore Skill from Unchained not as specific.
      #appenddesc[skLorOther,"{b}Shadow d20:{/b} Lore is changed to only be a little specific but NOT as restrictive as the book. Listed below are some new valid examples for what you could pick with Lore.{br}{br}-For gods list up to three gods.{br}-Any City, Town, Village regardless of size and know all areas of that location.{br}-Elves, Dwarves, Orcs, Half-Orcs, Goblins, or other specific race. But you can't say 'Humanoids'.{br}-Undead, Dragons, Aberrations, Devils, Demons, Lycanthrops, or other broad single Creature Type. So again you can't say 'Outsider (Evil)' but can list Devil or Demon."]

      ~ Unchained Sneak Attack
      #appenddesc[cSneakUnc,"{b}Shadow d20:{/b} The rogue can take advantage of the distractions that her allies attacks cause. When a creature is attacked in melee combat by an ally (regardless if its a hit or a miss) the rogue can deal sneak attack damage to that target until the end of the rogue's turn."]

      ~ Unchained poison note on Heal Skill
      if (hero.tagis[source.PUPoiDis] = 1) then
        #appenddesc[skHeal,"{b}Unchained:{/b} For every day of bed rest (or 2 nights of normal rest), a victim recovers one step; this recovery is doubled as normal by Heal checks, and tenacious poisons might require a longer recovery period."]
      endif

      var sText as string

      ~ Change feat text
      foreach thing in BaseFeat where "thingid.fElepStomp|thingid.fHeroicRec"
        ~ Elephant Stomp 
        If (eachthing.tagcountstr["thingid.fElepStomp"] = 1) Then
          perform eachthing.amendthing[description,"{b}Prerequisites:{/b} Str 13, Power Attack, Improved Overrun, base attack bonus +1.\n\n{b}Benefit:{/b} When you overrun an opponent and your maneuver check exceeds your opponent&#146;s CMD by 5 or more you can make one attack with an unarmed strike or a natural weapon against that opponent as a swift action.\n\n{b}Normal:{/b} When your overrun maneuver check exceeds your opponent's CMD by 5 or more, you move through the target's space and she is knocked prone.{br}{br}{B}Shadow d20:{/b} Changed wording to try and make this feat usuable."]
        Endif

        ~ Heroic Recovery feat and Unchained Poison rules active dd
        If (eachthing.tagcountstr["thingid.fHeroicRec"] + hero.tagis[source.PUPoiDis] = 2) Then
          perform eachthing.amendthing[description,"You can throw off the effects of crippling conditions.{br}{br}{b}Prerequisites{/b}: Diehard, Endurance, base Fortitude save +4.{br}{br}{b}Benefit{/b}: Once per day as a standard action you may attempt a new saving throw against a harmful condition or affliction requiring a Fortitude save that is affecting you. If this save against the affliction fails, there is no additional effect, but a successful save moves you up on the afflication track towards cured. You cannot use this feat to recover from instantaneous effects, effects that do not allow a saving throw, or effects that do not require a Fortitude save.{br}{br}{b}Shadow d20:{/b} This feat adjusted for use with Unchained poison/disease rules."]
        Endif

      nexteach

      ~ Fix Cape of Feinting
      foreach thing in BaseEquip where "thingid.ioCapeFein"
        If (eachthing.tagcountstr["thingid.ioCapeFein"] <> 0) Then
          ~ Build text string
          sText = eachthing.field[descript].text & "{br}{br}{b}Shadow d20:{/b} This cloak was not meant to have a unlimited daze ability. The ability to daze a target can only be done 3/day."
          ~ Set message
          perform eachthing.amendthing[description,sText]
        Endif
      nexteach

      ~ Add note about easy spellcasting with all shields
      foreach thing in BaseArmor where "ArmorClass.Shield"
        ~ Build text string
        sText = eachthing.field[descript].text & "{br}{br}{b}Shadow d20:{/b} Casting spells can be done with all types of shields. This requires no extra action and does not cause you to lose your shield bonus for the round."
        ~ Set message
        perform eachthing.amendthing[description,sText]
      nexteach            
      ]]></eval>
    </thing>


  <!-- ==================================================================================== -->
  <!-- Shadow d20 Unchained Action Economy text changes                                     -->
  <!-- ==================================================================================== -->
  <thing id="s20UAETxt" name="Shadow d20 Unchained Action Economy Text Changes" 
    description="This Thing sets the text desc on Things with house rules text." 
    compset="Simple">
    <usesource source="PURevActi"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Render" priority="200"><![CDATA[
      ~ Rapid Shot
      #appenddesc[fRapidShot,"{b}Shadow d20 UAE:{/b} Works the exact same way as Two-Weapon Fighting/Flurry of Blows."]

      ~ Vital Strike
      #appenddesc[fVitStr,"{b}Shadow d20 UAE:{/b} Can only be used on the first attack action each round."]
      #appenddesc[fGrtVitStr,"{b}Shadow d20 UAE:{/b} Can only be used on the first attack action each round."]
      #appenddesc[fImpVitStr,"{b}Shadow d20 UAE:{/b} Can only be used on the first attack action each round."]

      ~ Manyshot
      #appenddesc[fManyshot,"{B}Shadow d20 UAE:{/b} Manyshot is only used on the first attack action each round."]

      ~ Quick Channel
      #appenddesc[fQuickChan,"{b}Shadow d20 UAE:{/b} This feat allows you to use Channel Energy twice a round instead of only once."]

      ~ Channel Energy
      #appenddesc[xChannel,"{b}Shadow d20 UAE [Channel Energy (1 Act)]:{/b} 1 Action to use NOT 2 but you still can only use this ability once per round. Unless you take the feat Quick Channel which allows you to use Channel Energy twice per round."]

      ~ Warlock Eldritch Blast
      #appenddesc[cWitS2ElBl,"{b}Shadow d20 UAE [Warlock Eldritch Blast (Variable)]:{/b} Standard Eldritch Blast is 1 act but by adding any Hex that alters the Eldritch Blast the action type is changed to a complex action and costs 2 acts."]  

      ~ Pounce
      #appenddesc[raPounce,"{b}Shadow d20 UAE [Pounce (3 Acts)]:{/b} A creature with this special attack can move up to double its base movement speed by taking a -2 AC penalty and at the end of its movement it can make all its natural attacks vs a single target."]

      ~ Total Defense
      perform state.thing[pstTotDef].amendthing[description,"{b}(2 Acts){/b} You concentrate on defense rather than attacking. Until the start of your next turn, you can't take actions with the attack subtype, and you gain a +4 dodge bonus to AC.  If you have at least 3 ranks in Acrobatics the bonus increases to +6."]

      ~ Staggered
      perform state.thing[pcnStagger].amendthing[description,"A staggered creature may take only a single action each round. A creature with nonlethal damage exactly equal to its current hit points gains the staggered condition."]

      ~ Nauseated
      perform state.thing[pcnNausea].amendthing[description,"Creatures with the nauseated condition experience stomach distress. Nauseated creatures are unable to attack, cast spells, concentrate on spells, or do anything else requiring attention. When nauseated you have a single action per round which can only used for simply actions without the 'attack' subtype. In addition you can not cast or begin to cast any spells."]

      ~ Disabled
      perform state.thing[pcnDisable].amendthing[description,"A character with 0 hit points, or one who has negative hit points but has become stable and conscious, is disabled. A disabled character may take a single action each round and moves at half speed. Taking subtype actions of 'move' doesn't risk further injury, but performing any other subtype of action (or any other action the GM deems strenuous, including some swift actions such as casting a Quicken Spell spell) deals 1 point of damage after the completion of the act. Unless the action increased the disabled character's hit points, he is now in negative hit points and dying.\n\nA disabled character with negative hit points recovers hit points naturally if he is being helped. Otherwise, each day he can attempt a DC 10 Constitution check after resting for 8 hours, to begin recovering hit points naturally. The character takes a penalty on this roll equal to his negative hit point total. Failing this check causes the character to lose 1 hit point, but this does not cause the character to become unconscious. Once a character makes this check, he continues to heal naturally and is no longer in danger of losing hit points naturally."]

      ~ Nauseated
      perform state.thing[pcnNausea].amendthing[description,"Creatures with the nauseated condition experience stomach distress. Nauseated creatures are unable to attack, cast spells, concentrate on spells, or do anything else requiring attention. When nauseated you have only a single simple action a round that may only be used on actions without the 'attack' subtype or for casting a spell."]

      ]]></eval>
    </thing>

  <thing id="s20NoXP" name="No XP" 
    description="In our games we don't use XP anymore. Its much better to have characters advance when the 'story' says its a good time to level instead of when the players have killed enough monsters." 
    summary="We don't track XP in our games."
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <eval phase="PostAttr" priority="5000"><![CDATA[
      ~ This tag tells HL to not use XP!
      perform hero.assign[Hero.NoAdvance]
      ]]></eval>
    </thing>

  <!-- ======================================================================================= -->
  <!-- Text Only Notes                                                                         -->
  <!-- ======================================================================================= -->
  <thing id="S2CureSpls" name="Healing Magic" 
    description="In our games we have always allowed maximized healing from all non-magic items. This means if the spell or channel energy comes from your class abilities it is restores max hit points outside of combat or in non-stress areas.\n\nThis allows the game to keep moving forward more often and making the players rest less often. We find this an improvement to the game." 
    summary="Non-magic item healing outside of combat is Maximized!"
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    </thing>




  <!-- ======================================================================================= -->
  <!-- Fixes for teamwork feats                                                                -->
  <!-- ======================================================================================= -->
  <thing id="S20Teamwor" 
    name="Shadow d20 Teamwork Feats" 
    description="Add extra house rules text to all teamwork feats. Most of the teamwork feats we are allowing them to be used within 30ft of each other." 
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <eval phase="Render" priority="200"><![CDATA[
      ~ Set text fields
      var sTxt30 as string
      var sTxt10 as string
      var sText  as string

      sTxt30 = "{b}Shadow d20:{/b} This teamwork feat can be used within 30ft now."
      sTxt10 = "{b}Shadow d20:{/b} This Teamwork feat can be used within 10ft now."

      foreach thing in BaseFeat where "fCategory.Teamwork"
        ~ For some team work the distance is 10ft not 30ft
        If (eachthing.tagsearch["thingid.fAmpRage|thingid.fDuckCover|thingid.fShakeIt"] <> 0) Then
          sText = eachthing.field[descript].text & "{br}{br}" & sTxt10
        ~.. otherwise assume we need the 30ft text
        Else 
          sText = eachthing.field[descript].text & "{br}{br}" & sTxt30
        Endif
        ~ Set message
        perform eachthing.amendthing[description,sText]  
      nexteach]]></eval>
    </thing>

  <thing id="s20Tracker" name="Shadow d20 Tracker Reset to Max" 
    description="Set all trackers and action points to reset to Max instead of 0. This way a wand will be 50/50 instead of 50/50." 
    compset="Simple" 
    uniqueness="useronce">
    <usesource source="s20PFCamp"/>
    <eval phase="PreLevel" priority="10000"><![CDATA[      
      foreach pick in hero from Tracker where "User.Tracker|thingid.hActionPts"
        perform eachpick.assign[Helper.ResetMax]
      nexteach]]></eval>
    </thing>    

  <!-- ==================================================================================== -->
  <!-- Abilities to print to a character sheet.                                             -->
  <!-- ==================================================================================== -->
  <thing id="s2Info1Rou" name="Shadow d20 Cast Time" 
    description="All 1 round casting time spells have been adjusted down to 1 Full-Round action instead. In play 1 round spells are too big of a nerf to spellcasters. Please note that the casting time will only be changed AFTER you add the spell to your character not before."
    summary="1 round casting time spells are now 1 Full-Round action instead."
    compset="Ability">
    <usesource source="srcNo1Rnd"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Final" priority="10000"><![CDATA[
      ~ Only show us if we are a spellcaster
      If (hero.tagis[Hero.Caster] <> 0) Then
         perform assign[Helper.ShowSpec]
      Endif]]></eval>
    </thing>

  <thing id="s2InfoSpDm" name="Shadow d20 Spell Bonus Damage" 
    description="All hit point dealing spells and spell-like abilities now gain a damage bonus equal to your caster level (CL). This bonus only applies once to a spell, not once per missile or ray, and cannot be split between multiple missiles or rays. This bonus damage is not increased by Empower Spell or similar effects. This damage is of the same type as the spell." 
    summary="Hit Point damaging Spells and Sp get your CL as a damage bonus."
    compset="Ability">
    <usesource source="srcSpelDmg"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Final" priority="10000">
      ~ Only show us if we are a spellcaster
      doneif (hero.tagis[Hero.Caster] = 0)

      ~ Show us
      perform assign[Helper.ShowSpec]</eval>
    </thing>

  <thing id="s2InfoDbSp" 
    name="Shadow d20 Double Spells" 
    description="The number of spells per day for Arcanists, Sorcerers, and Wizards have been doubled. This allows these classes to keep up with the melee classes. Shadow d20 games combats run way longer than 3 rounds and easily have 4-6 encoutners per day. Spellcasters where running out of spells way too quickly." 
    summary="Spells per day have been doubled."
    compset="Ability">
    <usesource source="s20PFCamp"/>
    <tag group="Shadowd20" tag="HouseRule"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <eval phase="Final" priority="10000">
      ~ Only show us if we are a Wizard, Sorcerer, or Arcanist
      doneif (hero.tagis[Classes.Wizard] + hero.tagis[Classes.Sorcerer] + hero.tagis[Classes.Arcanist] = 0)

      ~ Show us
      perform assign[Helper.ShowSpec]</eval>
    </thing>



  <thing id="trkS2APs"
    name=" Action Points" description="A beginning (1st-level) character starts the game with 5 action points. A character above 1st level starts the game with a number of action points equal to 5 + 1/2 his current character level. Every time a character advances, he gains a number of action points equal to 5 + 1/2 his new character level.\n\nWhen you spend 1 action point to improve a d20 roll, you add the result of a 1d6 to your d20 roll (including attack rolls, saves, checks, or any other roll of a d20) to help you meet or exceed the target number. You can declare the use of 1 action point to alter a d20 roll after the roll is made, but only before the GM reveals the result of that roll. You cant use an action point to alter the result of a d20 roll when you are taking 10 or taking 20.\n\nDepending on character level, a character might be able to roll more than one d6 when he spends an action point. If so, apply the highest result and disregard the other rolls. A 15th-level character, for instance, gets to roll 3d6 and take the best result of the three. So, if he rolled a 1, 2, and 4, he would apply the 4 to his d20 roll. \n\n{B}1st-7th{/b} 1d6\n{B}8th-14th{/b} 2d6\n{B}15th-20th{/b} 3d6" 
      compset="Tracker" 
      replaces="hActionPts" 
      uniqueness="useronce">
    <fieldval field="trkMax" value="5"/>
    <usesource source="OptAction"/>
    <tag group="Usage" tag="S2Level" name="/level"/>
    <tag group="ProductId" tag="Shadowd20"/>
    <tag group="User" tag="Tracker"/>
    <tag group="ChargeCalc" tag="HitDieHalf"/>
    <tag group="ChargeCalc" tag="LevelX1"/>
    <tag group="Helper" tag="NoNightRes"/>
    <eval phase="Final" priority="10000"><![CDATA[
      var dice as number
      ~ Default is 1d6
      dice = 1

      ~ Calcaulte the number of dice to roll
      If (herofield[tLevel].value >= 8) Then
        dice += 1
      Endif
      If (herofield[tLevel].value >= 15) Then
        dice += 1
      Endif

      ~ Set livename
      field[livename].text = field[name].text & " " & dice & "d6"]]></eval>
    </thing>



  <hidden id="fKQImpDA"/>
  <hidden id="fKQAddFavE"/>
  <hidden id="fKQAddFavT"/>
  <hidden id="cRslAddAC"/>
  <hidden id="fKQDeadAcc"/>
  <preclude id="raS2CatSce" source="ARG"/>
  <preclude id="raS2CatCle" source="ARG"/>
  <preclude id="raS2CatCli" source="ARG"/>
  <preclude id="rKitsune" source="srcNoRaces"/>
  <preclude id="rTengu" source="srcNoRaces"/>
  <preclude id="rcMwangi" source="srcCatFolk"/>
  <preclude id="fLeader" source="s20PFCamp"/>
  <preclude id="iElvenChn" source="s20PFCamp"/>
  <preclude id="iDwarfPlt" source="s20PFCamp"/>
  <preclude id="rcShoanti" source="srcShifter"/>
  <preclude id="rcUlfen" source="srcShaMino"/>
  <preclude id="spCorrTou1" source="s20PFCamp"/>
  <preclude id="rTiefling" source="srcNoRaces"/>
  <preclude id="rCatfolk" source="srcNoRaces"/>
  <preclude id="rRatfolk" source="srcNoRaces"/>
  <preclude id="rAasimar" source="srcNoRaces"/>
  <preclude id="raS2CatCur" source="ARG"/>
  <preclude id="raS2CatFal" source="ARG"/>
  </document>
